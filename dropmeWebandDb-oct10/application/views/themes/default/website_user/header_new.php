<?php defined('SYSPATH') OR die('No direct access allowed.'); ?>

<div style="display: none;">
    <svg version="1.1" id="ref_code" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 16 16" style="enable-background:new 0 0 16 16;" xml:space="preserve">
<g id="XMLID_6_">
	<g id="XMLID_7_">
		<g id="XMLID_8_">
			<path id="XMLID_12_" class="st0" d="M2.2,4.1c0,1,0.8,1.8,1.8,1.8s1.8-0.8,1.8-1.8S5.1,2.3,4.1,2.3S2.2,3.1,2.2,4.1z M3,4.1
				C3,3.5,3.5,3,4.1,3s1.1,0.5,1.1,1.1S4.7,5.2,4.1,5.2S3,4.7,3,4.1z"/>
			<path id="XMLID_9_" class="st0" d="M0,1.9v4.9C0,7.3,0.2,7.7,0.6,8l7.3,7.3c0.3,0.3,0.8,0.5,1.3,0.5s1-0.2,1.3-0.5l4.9-4.9
				c0.7-0.7,0.7-1.9,0-2.6L8.1,0.6C7.8,0.3,7.3,0.1,6.8,0.1H1.9C0.9,0.1,0,0.9,0,1.9z M0.8,6.8V1.9c0-0.6,0.5-1.1,1.1-1.1h4.9
				c0.3,0,0.6,0.1,0.8,0.3l7.3,7.3c0.4,0.4,0.4,1.1,0,1.6L10,14.9c-0.2,0.2-0.5,0.3-0.8,0.3s-0.6-0.1-0.8-0.3L1.1,7.5
				C0.9,7.3,0.8,7.1,0.8,6.8L0.8,6.8z"/>
		</g>
	</g>
</g>
</svg>

    
    <svg version="1.1" id="notification" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 15 15" style="enable-background:new 0 0 15 15;" xml:space="preserve">
    <g id="XMLID_14_">
	<defs>
		<path id="XMLID_15_" d="M14.2,11.2c-1.3-1.1-2.5-2.7-2.5-6.7c0-2.3-1.9-4.2-4.2-4.2c-2.3,0-4.2,1.9-4.2,4.2c0,4-1.2,5.6-2.5,6.7
			c-0.4,0.3-0.6,0.8-0.6,1.3c0,0.3,0.2,0.5,0.5,0.5h4.5c0.2,1.1,1.2,1.9,2.3,1.9c1.1,0,2.1-0.8,2.3-1.9h4.5c0.3,0,0.5-0.2,0.5-0.5
			C14.8,11.9,14.6,11.5,14.2,11.2L14.2,11.2z M7.5,13.8c-0.6,0-1.1-0.4-1.3-0.9h2.6C8.6,13.4,8.1,13.8,7.5,13.8L7.5,13.8z M1.4,12
			C1.4,11.9,1.4,11.9,1.4,12c2-1.8,2.9-4,2.9-7.5c0-1.8,1.4-3.2,3.2-3.2c1.8,0,3.2,1.5,3.2,3.2c0,3.5,0.9,5.7,2.8,7.5
			c0,0,0,0,0.1,0.1H1.4L1.4,12z"/>
	</defs>
	<use xlink:href="#XMLID_15_"  style="overflow:visible;"/>
	<clipPath id="XMLID_72_">
		<use xlink:href="#XMLID_15_"  style="overflow:visible;"/>
	</clipPath>
    </g>
</svg>

<svg version="1.1" id="acc_balance" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 16 16" style="enable-background:new 0 0 16 16;" xml:space="preserve">
<g id="XMLID_28_">
	<g id="XMLID_29_">
		<defs>
			<path id="XMLID_30_" d="M15.7,16H1.3C1.1,16,1,15.9,1,15.7V6.8c0-0.2,0.1-0.3,0.3-0.3h3.6c0,0,0,0,0-0.1l3-5.4C7.9,1.1,8,1,8.1,1
				c0.1,0,0.1,0,0.2,0l2,1.2c0,0,0,0,0,0l0.6-0.6c0.1-0.1,0.3-0.1,0.4,0l3.6,3.7c0.1,0.1,0.1,0.1,0.1,0.2c0,0.1,0,0.1-0.1,0.2
				L14,6.6h1.7c0.1,0,0.3,0.1,0.3,0.3v2.5v3.3v3.1C16,15.9,15.9,16,15.7,16L15.7,16z M8.2,1.6L5.4,6.6H6l3.9-3.9L8.2,1.6L8.2,1.6z
				 M14.3,5.5L11,2.2L6.8,6.6h6.5L14.3,5.5L14.3,5.5z M15.5,9.6h-3.5c-0.5,0-0.8,0.4-0.8,0.8v1.1c0,0.5,0.4,0.8,0.8,0.8h3.5V9.6
				L15.5,9.6z M15.5,12.9h-3.5c-0.8,0-1.4-0.6-1.4-1.4v-1.1c0-0.8,0.6-1.4,1.4-1.4h3.5V7.1h-2c0,0-0.1,0-0.1,0c0,0-0.1,0-0.1,0H1.5
				v8.3h13.9V12.9L15.5,12.9z M12.2,11.6c-0.3,0-0.5-0.2-0.5-0.6s0.2-0.6,0.5-0.6c0.3,0,0.5,0.2,0.5,0.6S12.5,11.6,12.2,11.6
				L12.2,11.6z"/>
		</defs>
		<use xlink:href="#XMLID_30_"  style="overflow:visible;"/>
		<clipPath id="XMLID_37_">
			<use xlink:href="#XMLID_30_"  style="overflow:visible;"/>
		</clipPath>
	</g>
</g>
</svg>
    
    
    
</div>

<?php
$action = Request::initial()->action();
$toggle_menu = "";
$redirection = URL_BASE;
if($action == "passenger_dashboard" || $action == "completed_trips" || $action == "transaction_details" || $action == "cancelled_trips" || $action == "passenger_editprofile" || $action == "change_password" || $action == "payment_option" || $action == "add_money" || $action == "add_card_details" || $action == "update_card_details") {
	$toggle_menu = "menu_icon";
	$redirection = "javascript:;";
}
?>

<header>
	<div class="header_outer">
		<div class="header_inner">
			<a href="<?php echo $redirection; ?>" class="<?php echo $toggle_menu; ?>" id="menu_icon"><i class="fa fa-navicon"></i></a>
			<div class="logo">
				<img src="<?php echo URL_BASE . SITE_LOGO_IMGPATH . 'logo.png'; ?>" alt="" />
			</div>
			<?php //$details = Commonfunction::get_user_wallet_amount(); ?>
			<?php $alert = json_decode(ALERT); ?>
			<div class="header_rgt">
				<a href="#" title="Menu" class="toggleMenu" style="display:none;">&nbsp;</a> 
				<ul class="hnav">
					<li><p><?php echo  __('language'); ?>: 
						<span>
							<select id="language" name="language">
								<?php foreach($langArr as $lkey=>$lval): ?>
										<option value="<?php echo $lkey; ?>" <?php if($lkey == $language) { ?>selected<?php } ?> ><?php echo $lval; ?></option>
								<?php endforeach; ?>
							</select>
						</span></p></li>
					<li class="ref_code">
                                            <div class="icons_1"><svg viewBox="0 0 16 16" class="icon_17"><g><use xlink:href="#ref_code" class="icon_17"></use></g></svg></div>
                                            <p><?php echo  __('referral_code'); ?>: <span><?php echo PASSENGER_REFERRALCODE; ?></span></p>
                                        </li>
					<li class="alert">
                                            <div class="icons_1"><svg viewBox="0 0 15 15" class="icon_17"><g><use xlink:href="#notification" class="icon_17"></use></g></svg></div>
						<p><?php echo  __('alert'); ?>
							<?php if($alert->count > 0) { ?>
							<a id="header_alert" href="<?php if($action != "passenger_dashboard") { echo URL_BASE."dashboard.html#upcoming-trip"; } else { echo "#"; } ?>" class="view_details" data-condition="2" data-trip="<?php echo $alert->trip_id; ?>" data-id="1-upcomming"><?php echo $alert->count; ?></a>
							<?php } ?>
						</p>
					</li>
					<li class="acc_bln">
                                            <div class="icons_1"><svg viewBox="0 0 15 15" class="icon_17"><g><use xlink:href="#acc_balance" class="icon_17"></use></g></svg></div>
                                            <p><?php echo  __('acc_bal'); ?> : <span><?php echo CURRENCY.PASSENGER_WALLET; ?></span></p></li>
					<?php $userid = $global_session->get('id');  if(file_exists(DOCROOT.PASS_IMG_IMGPATH.$userid.".png")) {
						$profile_image = URL_BASE.PASS_IMG_IMGPATH.$userid.".png";
					} else {
						$profile_image = URL_BASE."public/frontend/logged_in/images/profile_noimage.png";
					} ?>
					<li class="usr_pro">
						<a href="<?php echo URL_BASE."edit-profile.html"; ?>">
							<img width="38" height="38" alt="user image" src="<?php echo $profile_image; ?>"/>
							<span><?php echo $global_session->get("passenger_name"); ?></span>
						</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
</header>
<?php
	$sucessful_message = Message::display();
	if($sucessful_message) { ?>
		<div id="messagedisplay">
			 <div class="alert alert-success">
				<?php /* <div class="success_float_tt">
					<button type="button" class="close close_message" data-dismiss="alert">Ã—</button>
					<label style="float: left; margin: 4px 0 0 6px;"><?php echo $sucessful_message; ?></label>
				</div> */ ?>
				<?php echo $sucessful_message; ?>
			</div>
		</div>
<?php } ?>
<script>
$(document).ready( function () {
	$(".close_message").click( function() {
		$("#messagedisplay").hide();
	});
	
	$(window).load(function() {
		if(window.location.hash) {
			if(window.location.hash == "#upcoming-trip") {
				$('.view_details[data-id=1-upcomming]').addClass('minize_icon');
				$('#upcomming-trip-1').toggle();
			}
		}
	});

	$(".view_details").live('click',function () {
		$(this).toggleClass('minize_icon');
		var condition = $(this).data("condition");
		var id = $(this).data("id");
		id = id.split("-");
		$("#"+id[1]+"-trip-"+id[0]).toggle();
		if(condition == 2) {
			$('.view_details[data-id=1-upcomming]').toggleClass('minize_icon');
			$.ajax({
				url:'<?php echo URL_BASE; ?>users/change_header_alert',
				type:'post',
				dataType:'json',
				data: {trip_id : $(this).data("trip")},
				success: function() {
					
				}
			});
			$("#header_alert").hide();
		}
	});
});
</script>
<script>
var ww = document.body.clientWidth;
$(document).ready(function() {
	$(".hnav li a").each(function() {
		if ($(this).next().length > 0) {
			$(this).addClass("parent");
		}
	});
	
	$(".toggleMenu").click(function(e) {
		e.preventDefault();
		$(this).toggleClass("active");
		$(".hnav").toggle();
	});
	adjustMenu();
	
	$("#language").change(function(){
		var lang = $(this).val();
		$.ajax({
			url:'<?php echo URL_BASE;?>users/setLanguage',
			type:'POST',
			data:"lang="+lang,
			success:function(res)
			{
				location.reload();
			}
		});
	});
})

$(window).bind('resize orientationchange', function() {
	ww = document.body.clientWidth;
	adjustMenu();
});

var adjustMenu = function() {
	if (ww < 1080) {	 
		jQuery(".toggleMenu").css("display", "inline-block");
		if (!jQuery(".toggleMenu").hasClass("active")) {
			jQuery(".hnav").css("display", "none");
		} else {
			jQuery(".nav").show();
		}
		jQuery(".hnav li").unbind('mouseenter mouseleave');
		jQuery(".hnav li a.parent").unbind('click').bind('click', function(e) {
			// must be attached to anchor element to prevent bubbling
			//e.preventDefault();
			jQuery(this).parent("li").toggleClass("hover");
		});
	} 
	else if (ww >= 1081) {
		jQuery(".toggleMenu").css("display", "none");
		jQuery(".hnav").css("display", "inline-block");
		jQuery(".hnav li").removeClass("hover");
		jQuery(".hnav li a").unbind('click');
		jQuery(".hnav li").unbind('mouseenter mouseleave').bind('mouseenter mouseleave', function() {
		 	// must be attached to li so that mouseleave is not triggered when hover over submenu
		 	jQuery(this).toggleClass('hover');
		});
	}
}

</script>
